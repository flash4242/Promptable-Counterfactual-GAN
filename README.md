# Promptable Counterfactual GAN

## Project details
- Project description: Our goal is to develop an explanatory algorithm in which explanations are generated by a generative model. These have the advantage of being prompted, so that we can, as users, instruct it what to generate. For example, we would like to use it to answer questions such as why a given person may or may not receive a loan of a certain value according to a differentiable binary classifier.
## Functions of the files in the repository
- Dockerfile: the docker/running environment for the project
- munkaterv.pdf: project description and schedule
- conditional_gan (folder): conditional GAN solutions
- simple_gan (folder): simple GAN solutions

## Related works
### Theory
- Generative Adversarial Nets: https://arxiv.org/pdf/1406.2661
- Conditional Generative Adversarial Nets: https://arxiv.org/pdf/1411.1784
- Wasserstein GAN: https://arxiv.org/pdf/1701.07875
- Unsupervised Representation Learning With Deep Convolutional Generative Adversarial Networks: https://arxiv.org/pdf/1511.06434
- Human friendly explanations from Interpretable Machine Learning by Cristoph Molnar: https://christophm.github.io/interpretable-ml-book/interpretability.html#explanation
- Counterfactual explanations from Interpretable Machine Learning by Cristoph Molnar: https://christophm.github.io/interpretable-ml-book/counterfactual.html
- CounterGAN: https://arxiv.org/pdf/2009.05199
- Convolutional Networks for Images, Speech, and Time-Series: https://citeseerx.ist.psu.edu/document?repid=rep1&type=pdf&doi=e26cc4a1c717653f323715d751c8dea7461aa105
- Convolutional Networks from the Dive into Deep Learning book: https://d2l.ai/chapter_convolutional-neural-networks/index.html
### Implementations and datasets
- Make_moons dataset: https://scikit-learn.org/stable/modules/generated/sklearn.datasets.make_moons.html
- MNIST dataset: https://www.kaggle.com/datasets/hojjatk/mnist-dataset
- GAN implementations for the make_moons dataset: https://github.com/dataflowr/notebooks/blob/master/Module10/10_GAN_double_moon.ipynb
- Simple MLP GAN for MNIST dataset in PyTorch: https://github.com/vamsi3/simple-GAN/blob/master/src/PyTorch/gan-mnist-pytorch.py
- DCGAN for generating MNIST digits in PyTorch: https://medium.com/@simple.schwarz/how-to-build-a-gan-for-generating-mnist-digits-in-pytorch-b9bf71269da8
- Conditional WGAN using PyTorch: https://medium.com/@ngoodger_7766/conditional-gan-using-pytorch-7849a62fbcad

(every URL accessed on 2025.04.07.)


## How to run it
The steps below describe the run process for Ubuntu 22.04. operating system release. Make sure that Docker (https://www.docker.com/) is installed on your system before executing the commands below.<br/><br/>
Build the Dockerfile (standing in the directory, where the abovementioned Dockerfile is):
```
docker build -t your_image_name .
```

Start the container with the following command (standing in the directory, where the abovementioned files are). Make sure to mount the directory under which MNIST dataset is available when you try to run the MNIST codes.
```
docker run -it --rm --gpus=all -v $(pwd):/home/yourUser -v /mnt/:/mnt/ your_image_name
```

Inside the container, in bash, add execution rights to the file you want to run:
```
chmod +x make_moons_gan.py


```

Then run the file:
```
./make_moons_gan.py
```
